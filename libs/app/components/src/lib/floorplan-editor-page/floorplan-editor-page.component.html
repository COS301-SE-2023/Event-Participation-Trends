<div class="top-0 left-0 w-full h-screen">
  <div class="grid grid-cols-12 gap-3 p-3 h-full">
    <div
      class="tool-menu col-span-2 rounded-lg bg-white md:rounded-xl shadow-[0px_5px_15px_2px_rgba(0,0,0,0.2)] text-ept-deep-grey relative"
      ngClass="card-container"
    >
      <div ngClass="card" [class.flipped]="isCardFlipped && isSensor()">
        <div ngClass="front-side">
          <div class="flex flex-row justify-evenly">
            <h1 class="text-lg font-semibold text-center mt-5">Tools</h1>
            <button
              id="hover-trigger"
              *ngIf="isSensor()"
              class="mt-4 rounded-lg overflow-hidden self-center bg-ept-deep-grey hover:scale-105 duration-300 transition-all"
              title="Click to view linked sensors"
              (click)="toggleCardFlip()"
            >
              <!-- <ion-icon name="repeat" class="w-8 h-8"></ion-icon> -->
            </button>
          </div>
          <h3
            class="components-heading flex justify-between items-center mt-4 ml-2 md:text-md"
          >
            Components
          </h3>
          <div class="components-list mb-1 overflow-hidden">
            <div
              class="overflow-y-auto max-h-fit flex"
              [ngClass]="{'disabled opacity-50 pointer-events-none': !preventCreatingWalls}"
            >
              <img
                id="sensorImage"
                class="border-2 rounded-lg p-1 w-10 h-10 mt-2 cursor-grab"
                draggable="true"
                (dragstart)="onDragStart($event)"
                src="assets/sensor.png"
                alt="sensor"
              />
              <label class="text-ept-deep-grey opacity-40 mt-4 ml-4"
                >Sensor</label
              >
            </div>
            <div
              class="overflow-y-auto max-h-52 flex"
              [ngClass]="{'disabled opacity-50 pointer-events-none': !preventCreatingWalls}"
            >
              <img
                class="border-2 rounded-lg p-1 w-10 h-10 mt-2 cursor-grab"
                #stall
                draggable="true"
                (dragstart)="onDragStart($event)"
                src="assets/stall-icon.png"
                alt="stall"
              />
              <label class="text-ept-deep-grey opacity-40 mt-4 ml-4"
                >Stall</label
              >
            </div>
            <div
              class="overflow-y-auto max-h-52 flex"
              [ngClass]="{'disabled opacity-50 pointer-events-none': !preventCreatingWalls}"
            >
              <img
                id="textBox"
                class="border-2 rounded-lg p-1 w-10 h-10 mt-2 cursor-grab"
                draggable="true"
                (dragstart)="onDragStart($event)"
                src="assets/text-selection-svgrepo-com.svg"
                alt="sensor"
              />
              <label class="text-ept-deep-grey opacity-40 mt-4 ml-4"
                >Text</label
              >
            </div>
          </div>
          <h3 class="attributes-heading mt-3 ml-2 ml-2 md:text-md">Component Attributes</h3>
          <div
            *ngIf="!shouldStackVertically"
            id="attributes-container"
            class="flex flex-col cursor-default"
          >
            <div class="mt-2 p-2" lines="none">
              <label [ngClass]="{'opacity-50 pointer-events-none' : !preventCreatingWalls || activeItem === null || !selectedWall}">Text:</label>
              <input
                #textInput
                id="textInput"
                aria-label=""
                class="input focus:outline-none focus:ring-2 focus:ring-blue-500 border-2 rounded h-7 w-[200px]"
                type="text"
                pattern="[a-zA-Z0-9 ]*"
                [value]="activeItem ? getActiveItemText() : ''"
                (input)="updateText($event)"
                [ngClass]="{'opacity-50 pointer-events-none' : !preventCreatingWalls || activeItem === null || !selectedWall}"
                [attr.maxlength]="getMaxTextLength()"
                label="Text:"
                labelPlacement="floating"
              />
            </div>
            <p 
              class="text-ept-deep-grey mr-4 flex flex-row justify-end text-xs"
              [ngClass]="{'opacity-50' : !selectedTextBox}">{{getTextLength()}}/{{getMaxTextLength()}}</p>
            <div class="attributes-list flex flex-row items-center justify-evenly mt-2 p-2" lines="none">
              <label class="flex mr-3 min-w-fit" [ngClass]="{'opacity-50' : !preventCreatingWalls || activeItem === null || !selectedWall}">Length:</label>
              <input
                aria-label=""
                class="flex input-field input focus:outline-none focus:ring-2 focus:ring-blue-500 border-2 rounded h-7 w-[100px]"
                type="number"
                step="0.5"
                [value]="(activeItem && selectedWall) ? getActiveItemWidth() : 0"
                (input)="updateWidth($event)"
                [ngClass]="{'opacity-50 pointer-events-none' : !preventCreatingWalls || activeItem === null || !selectedWall}"
              />
            </div>
            <div class="attributes-list flex flex-row items-center justify-evenly mt-2 p-2" lines="none">
              <label class="flex mr-3 min-w-fit" [ngClass]="{'opacity-50' : !preventCreatingWalls || activeItem === null || selectedSensor}">Angle:</label>
              <input
                aria-label=""
                class="flex input-field input focus:outline-none focus:ring-2 focus:ring-blue-500 border-2 rounded h-7 w-[100px]"
                type="number"
                step="1"
                [value]="(activeItem && !selectedSensor) ? getActiveItemRotation() : 0"
                (input)="updateRotation($event)"
                [ngClass]="{'opacity-50 pointer-events-none' : !preventCreatingWalls || activeItem === null || !selectedWall}"
              />
            </div>
          </div>
          <div
            *ngIf="shouldStackVertically"
            id="attributes-container"
            class="flex flex-col items-center justify-evenly"
          >
            <div class="mt-3">
              <div class="p-1">
              <input
                #textInput
                id="textInput"
                aria-label=""
                class="input focus:outline-none focus:ring-2 focus:ring-blue-500 border-2 rounded h-7"
                type="text"
                pattern="[a-zA-Z0-9 ]*"
                [value]="activeItem ? getActiveItemText() : ''"
                (input)="updateText($event)"
                [disabled]="!preventCreatingWalls || activeItem === null|| !selectedTextBox"
                maxlength="15"
                label="Text:"
                labelPlacement="floating"
              />
              <p class="text-ept-deep-grey opacity-40 mr-4 flex flex-row justify-end text-xs">{{getTextLength()}}/{{getMaxTextLength()}}</p>
              </div>
            </div>
            <div class="mt-3">
              <label [ngClass]="{'opacity-50' : !preventCreatingWalls || activeItem === null || !selectedWall}">Length:</label><br/>
              <input
                aria-label=""
                class="input-field input focus:outline-none focus:ring-2 focus:ring-blue-500 border-2 rounded h-7"
                type="number"
                step="0.5"
                [value]="(activeItem && selectedWall) ? getActiveItemWidth() : 0"
                (input)="updateWidth($event)"
                [disabled]="!preventCreatingWalls || activeItem === null || !selectedWall"
                [ngClass]="{'opacity-50' : !preventCreatingWalls || activeItem === null || selectedSensor || !selectedWall}"
              >
            </div>
            <div class="mt-3">
              <label [ngClass]="{'opacity-50' : !preventCreatingWalls || activeItem === null || selectedSensor}">Angle:</label><br/>
              <input
                aria-label=""
                class="input-field input focus:outline-none focus:ring-2 focus:ring-blue-500 border-2 rounded h-7 mt-3"
                type="number"
                step="1"
                [value]="(activeItem && !selectedSensor) ? getActiveItemRotation() : 0"
                (input)="updateRotation($event)"
                [disabled]="!preventCreatingWalls || activeItem === null || selectedSensor"
                [ngClass]="{'opacity-50' : !preventCreatingWalls || activeItem === null || selectedSensor}"
              >
            </div>
          </div>

          <div class="mt-4 text-center">
            <div class="flex flex-row justify-evenly items-center mb-4">
              <label *ngIf="isLargeScreen" [ngClass]="{'opacity-50' : !preventCreatingWalls}">Component Selection</label>
              <div *ngIf="!isLargeScreen" class="selection-mode-tooltip-container">
                <img 
                  src="assets/selection-mode-icon.svg" 
                  alt="selection" 
                  class="w-10 h-12" 
                  [ngClass]="{'opacity-30' : !preventCreatingWalls, 'w-8 h-10': !isLargeScreen}"
                >
                <div class="selection-mode-tooltip">You are able to select components</div>
              </div>
              <div class="flex items-center justify-center w-full">
  
                <label for="toggleB" class="flex items-center cursor-pointer" (change)="toggleEditing()">
                  <!-- toggle -->
                  <div class="relative">
                    <!-- input -->
                    <input type="checkbox" id="toggleB" class="sr-only">
                    <!-- line -->
                    <div class="block bg-gray-600 w-14 h-8 rounded-full"></div>
                    <!-- dot -->
                    <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"></div>
                  </div>
                </label>
              
              </div>
              <!-- <ion-toggle
                aria-label="Warning toggle"
                [checked]="!preventCreatingWalls"
                class="col-span-1"
                (ionChange)="toggleEditing()"
              ></ion-toggle> -->
              <label *ngIf="isLargeScreen" [ngClass]="{'opacity-50' : preventCreatingWalls}">Wall Creation</label>
              <div *ngIf="!isLargeScreen" class="wall-creation-tooltip-container">
                <img 
                  src="assets/wall-creation-icon.svg" 
                  alt="wall-creation" 
                  class="w-10 h-12 mb-4"
                  [ngClass]="{'opacity-30' : preventCreatingWalls, 'w-8 h-10': !isLargeScreen}"
                >
                <div *ngIf="!preventCreatingWalls" class="wall-creation-tooltip">You are able to create walls</div>
              </div>
            </div>
            <div class="absolute mt-[140px] ml-[70px]">
              <button
                (click)="saveFloorLayout()"
                class="create-event h-40px w-[100px] text-ept-off-white text-sm/16 rounded-lg bg-green-500 drop-shadow-lg hover:scale-102 hover:bg-opacity-100 hover:shadow-[0px_2px_7px_2px_rgba(0,0,0,0.2)]"
                >Save
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div
        id="canvasParent"
        #canvasParent
        class="relative col-span-10 bg-white rounded-lg md:rounded-xl shadow-[0px_5px_15px_2px_rgba(0,0,0,0.2)] text-ept-deep-grey p-2"
        (drop)="onDrop($event)"
        (dragover)="onDragOver($event)"
        >
        <p
            class="bg-white z-50 rounded-md text-center text-2xl text-ept-deep-grey text-opacity-30 font-semibold mt-10 absolute top-1/2 left-1/3"
            *ngIf="canvasItems.length === 0 && preventCreatingWalls"
        >
            Drag a component to the canvas
        </p>
        <p
            class="bg-white z-50 rounded-md text-center text-2xl text-ept-deep-grey text-opacity-30 font-semibold mt-10 absolute top-1/2 left-1/3"
            *ngIf="canvasItems.length === 0 && !preventCreatingWalls"
        >
            Click and drag to create walls
        </p>
        <div
            id="canvasElement"
            #canvasElement
            class="border-ept-off-white border-2 rounded-lg md:rounded-xl w-full h-full"
        ></div>
        <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2">
            <img
            #dustbin
            *ngIf="canvasItems.length > 0"
            class="dustbin"
            (dragover)="onDustbinDragOver($event)"
            (dragleave)="onDustbinDragLeave($event)"
            (mouseup)="onDustbinMouseUp($event)"
            [ngClass]="{'drag-over': openDustbin}"
            [src]="chooseDustbinImage()"
            alt="trash"
            class="bg-white h-10 transition-all duration-300"
            />
        </div>
        <div class="absolute bottom-2.5 right-2.5 bg-ept-off-white border-2 border-ept-deep-grey rounded">
            <label id="scaleLabel" class="text-ept-deep-grey p-0.5 rounded">1 Block = {{gridSizeLabel}}m</label>
            <br/>
            <label id="scaleLabel" class="text-ept-deep-grey p-0.5 rounded">1 Snap = {{snapLabel}}m</label>
        </div>
        <div class="absolute bottom-2.5 left-2.5 flex flex-row bg-ept-off-white">
            <div>
            <img
                class="h-8 w-8 mr-1 border-2 p-0.5 border-ept-deep-grey cursor-pointer rounded"
                src="assets/zoom-in-svgrepo-com.svg"
                alt="zoom in"
                (click)="zoomIn()"
                [ngClass]="{'opacity-50 pointer-events-none border-opacity-50': zoomInDisabled}"
            >
            </div>
            <div>
            <img
                class="h-8 w-8 border-2 p-0.5 border-ept-deep-grey cursor-pointer rounded"
                src="assets/zoom-out-svgrepo-com.svg"
                alt="zoom out"
                (click)="zoomOut()"
                [ngClass]="{'opacity-50 pointer-events-none border-opacity-50': zoomOutDisabled}"
            >
            </div>
        </div>
    </div>
  </div>
</div>
